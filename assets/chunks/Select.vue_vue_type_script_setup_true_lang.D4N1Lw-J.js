import{d as A,s as p,a7 as P,h as O,v as I,D as K,o as d,c as f,I as h,w as g,e as U,j as W,F as j,E as q,n as v,a0 as b,k as z,b as x}from"./framework.DMj_wZv2.js";import{_ as G}from"./Tooltip.vue_vue_type_script_setup_true_lang.YXdFxDUK.js";import{_ as J}from"./Input.vue_vue_type_script_setup_true_lang.JgObGgse.js";import{_ as Q,i as C}from"./Icon.vue_vue_type_script_setup_true_lang.D9P5BK97.js";import{R as T}from"./RenderVnode.BzhqgW31.js";import{t as X}from"./throttle.j7vRPn8F.js";const Y={key:0,class:"pf-select__loading"},Z={class:"pf-select__menu"},ee=["id","onClick"],de=A({name:"PfSelect",inheritAttrs:!1,__name:"Select",props:{modelValue:{},options:{default:()=>[]},placeholder:{},disabled:{type:Boolean},clearable:{type:Boolean},renderLabel:{},filterable:{type:Boolean},filterMethod:{},remote:{type:Boolean},remoteMethod:{}},emits:["change","update:modelValue","visible-change","clear"],setup(M,{emit:$}){const _=l=>{const o=t.options.find(c=>c.value===l);return o||null},t=M,r=$,m=p(),V=p(),i=p(!1),B={modifiers:[{name:"offset",options:{offset:[0,9]}},{name:"sameWidth",enabled:!0,fn:({state:l})=>{l.styles.popper.width=`${l.rects.reference.width}px`},phase:"beforeWrite",requires:["computeStyles"]}]},n=p(t.options),u=_(t.modelValue),e=P({inputValue:(u==null?void 0:u.label)??"",selectedOption:u,mouseHover:!1,loading:!1,highlightIndex:-1}),D=O(()=>t.clearable&&e.mouseHover&&e.selectedOption&&e.inputValue.trim()!==""),F=O(()=>t.filterable&&e.selectedOption&&i.value?e.selectedOption.label:t.placeholder);I(()=>t.options,l=>{n.value=l}),I(()=>t.modelValue,l=>{const o=_(l);e.inputValue=o?o.label:"",e.selectedOption=o});const k=X(async l=>{if(t.filterable){if(t.filterMethod&&C(t.filterMethod))n.value=t.filterMethod(l);else if(t.remote&&t.remoteMethod&&C(t.remoteMethod)){e.loading=!0;try{n.value=await t.remoteMethod(l)}catch(o){console.error(o),n.value=[]}finally{e.loading=!1}}else n.value=t.options.filter(o=>o.label.includes(l));e.highlightIndex=-1}},300),N=()=>{k(e.inputValue)},s=l=>{l?(t.filterable&&e.selectedOption&&(e.inputValue=""),t.filterable&&k(e.inputValue),m.value.show()):(m.value.hide(),t.filterable&&(e.inputValue=e.selectedOption?e.selectedOption.label:""),e.highlightIndex=-1),i.value=l,r("visible-change",l)},R=l=>{switch(l.key){case"Enter":i.value?e.highlightIndex>-1&&n.value[e.highlightIndex]?y(n.value[e.highlightIndex]):s(!1):s(!0);break;case"Escape":i.value&&s(!1);break;case"ArrowDown":l.preventDefault(),n.value.length>0&&(e.highlightIndex===-1||e.highlightIndex===n.value.length-1?e.highlightIndex=0:e.highlightIndex++);break;case"ArrowUp":l.preventDefault(),n.value.length>0&&(e.highlightIndex===-1||e.highlightIndex===0?e.highlightIndex=n.value.length-1:e.highlightIndex--);break}},S=()=>{e.selectedOption=null,e.inputValue="",r("clear"),r("change",""),r("update:modelValue","")},E=()=>{},H=()=>{t.disabled||(i.value?s(!1):s(!0))},y=l=>{l.disabled||(e.inputValue=l.label,e.selectedOption=l,r("change",l.value),r("update:modelValue",l.value),s(!1),V.value.ref.focus())};return(l,o)=>{const c=K("pf-icon");return d(),f("div",{class:v(["pf-select",{"is-disabled":l.disabled}]),onClick:H,onMouseenter:o[2]||(o[2]=a=>e.mouseHover=!0),onMouseleave:o[3]||(o[3]=a=>e.mouseHover=!1)},[h(G,{placement:"bottom-start",manual:"",popperOptions:B,onClickOutside:o[1]||(o[1]=a=>s(!1)),ref_key:"tooltipRef",ref:m},{content:g(()=>[e.loading?(d(),f("div",Y,[h(c,{icon:"fa-spinner",spin:""})])):U("",!0),W("ul",Z,[(d(!0),f(j,null,q(n.value,(a,L)=>{var w;return d(),f("li",{key:a.value,class:v(["pf-select__menu-item",{"is-disabled":a.disabled,"is-selected":((w=e.selectedOption)==null?void 0:w.value)===a.value,"is-highlighted":e.highlightIndex===L}]),id:`select-item-${a.value}`,onClick:b(te=>y(a),["stop"])},[h(z(T),{vNode:l.renderLabel?l.renderLabel(a):a.label},null,8,["vNode"])],10,ee)}),128))])]),default:g(()=>[h(J,{ref_key:"inputRef",ref:V,modelValue:e.inputValue,"onUpdate:modelValue":o[0]||(o[0]=a=>e.inputValue=a),disabled:l.disabled,placeholder:F.value,readonly:!l.filterable||!i.value,onInput:N,onKeydown:R},{suffix:g(()=>[D.value?(d(),x(c,{key:0,icon:"circle-xmark",class:"pf-input__clear",onMousedown:b(E,["prevent"]),onClick:b(S,["stop"])})):(d(),x(Q,{key:1,icon:"angle-down",class:v(["header-angle",{"is-active":i.value}])},null,8,["class"]))]),_:1},8,["modelValue","disabled","placeholder","readonly"])]),_:1},512)],34)}}});export{de as _};
